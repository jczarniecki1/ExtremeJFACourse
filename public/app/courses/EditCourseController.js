// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('app').controller('EditCourseController', function($scope, CachedCourse, NotifierService, $location, $routeParams) {
    var courseId;
    courseId = $routeParams.id;
    CachedCourse.query().$promise.then(function(collection) {
      return collection.findById(courseId, function(course) {
        $scope.course = course;
        $scope.title = course.title;
        $scope.description = course.description;
        $scope.featured = course.featured;
        return $scope.tags = course.tags.join(', ');
      });
    });
    return $scope.submit = function() {
      var clone, updatedCourseData;
      updatedCourseData = {
        title: $scope.title,
        description: $scope.description,
        featured: $scope.featured,
        tags: ($scope.tags || "").replace(/[^a-zA-Z]*/, ' ').split(' ').slice(1).filter(function(x) {
          return x.length > 0;
        })
      };
      clone = angular.copy($scope.course);
      angular.extend(clone, updatedCourseData);
      return clone.$update({
        id: courseId
      }).then(function() {
        NotifierService.notify('Course updated successfully');
        angular.extend($scope.course, updatedCourseData);
        return $location.path("/courses/" + courseId);
      }, NotifierService.error);
    };
  });

}).call(this);

//# sourceMappingURL=EditCourseController.map
