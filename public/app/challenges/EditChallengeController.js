// Generated by CoffeeScript 1.7.1
(function() {
  angular.module('app').controller('EditChallengeController', function($scope, CachedChallenge, $location, $routeParams, NotifierService) {
    var challengeId, courseId;
    courseId = $routeParams.courseId;
    challengeId = $routeParams.challengeId;
    $scope.levels = ["basic", "advanced", "expert"];
    CachedChallenge.query({
      courseId: courseId
    }).$promise.then(function(collection) {
      return $scope.challengeIndex = collection.findById(challengeId, function(challenge) {
        $scope.challenge = challenge;
        $scope.description = challenge.description;
        $scope.level = challenge.level;
        $scope.jsonData = challenge.jsonData;
        $scope.initialInput = challenge.initialInput;
        return $scope.correctAnswerExpression = challenge.correctAnswerExpression;
      });
    });
    return $scope.submit = function() {
      var clone, updatedChallengeData;
      updatedChallengeData = {
        description: $scope.description,
        level: $scope.level,
        jsonData: $scope.jsonData,
        initialInput: $scope.initialInput,
        correctAnswerExpression: $scope.correctAnswerExpression
      };
      clone = angular.copy($scope.challenge);
      angular.extend(clone, updatedChallengeData);
      return clone.$update({
        courseId: courseId,
        id: challengeId
      }).then(function() {
        NotifierService.notify('Challenge updated successfully');
        angular.extend($scope.challenge, updatedChallengeData);
        return $location.path("/courses/" + courseId + "/challenge/" + challengeId);
      }, NotifierService.errorn);
    };
  });

}).call(this);

//# sourceMappingURL=EditChallengeController.map
